{{ define "main" }}
  {{ $style := resources.Get "css/papers.css" | resources.Minify }}
  <style>{{ $style.Content | safeCSS }}</style>
  <main class="papers">
    <header class="papers__header">
      <p class="papers__eyebrow">Selected Publications</p>
      <h1 class="papers__title">{{ site.Title }}</h1>
    </header>

    {{ $pubs := sort (where site.RegularPages "Section" "publications") "Date" "desc" }}
    {{ range $pubs }}
      {{ $authors := slice }}
      {{ range .Params.authors }}
        {{- with site.GetPage (printf "authors/%s" .) -}}
          {{ $authors = $authors | append .Title }}
        {{- else -}}
          {{ $authors = $authors | append . }}
        {{- end -}}
      {{ end }}
      {{ $author_line := delimit $authors ", " }}

      <article class="paper paper--preview" id="{{ .File.ContentBaseName }}">
        <p class="paper__venue">
          {{ with .Params.publication_short }}{{ . }}{{ else }}{{ .Params.publication }}{{ end }}
          · {{ .Date.Format "2006" }}
        </p>
        <h2 class="paper__title">
          <a href="{{ .RelPermalink }}">{{ .Title }}</a>
        </h2>
        <p class="paper__authors">{{ $author_line }}</p>

        {{ with .Params.summary }}
          <p class="paper__summary">{{ . }}</p>
        {{ end }}

        <a class="paper__primary-link" href="{{ .RelPermalink }}">View Paper →</a>
      </article>
    {{ end }}
  </main>
{{ end }}
